---
title: "Question 2"
output: html_document
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggpubr)
library(gridExtra)

DSdata <- read_csv("C:/Users/Juan Solorio/Desktop/DataScience/Grad School/Classes/Data 557/557_Final_Project/Data/DataScienceData.csv")
```

## **Question 2: Do similar data science jobs that involve different programming languages see comparable salaries (i.e. Data Analyst/Data Scientist, Machine Learning Engineer/Machine Learning Scientist)?**

We needed to create groups for the 17 different entries to the Current Job Title descriptions. For this we decided upon grouping titles into 'Scientist' (people probably utilizing higher level math/statistics), 'ResearchAnalyst' (those focused with general data analysis and manipulation), 'Engineer' (titles focused in the data engineering or software), and 'Other' (description unknown).

```{r, Jobtitlegroups}

Scientists <- c("Statistician", "Data Scientist", "Machine Learning Engineer", "Predictive Modeler", "Scientist/Researcher")
ResearchAnalyst <- c("Data Analyst", "Business Analyst", "Data Miner", "Researcher")
Engineer <- c("Software Developer/Software Engineer", "Programmer", "Computer Scientist", "Operations Research Practitioner", "Engineer", "DBA/Database Engineer")

DSdata1 <- DSdata[,] 
DSdata1$CapSalary <- if_else(DSdata1$CompensationYearUSD > 500000, 500000, DSdata1$CompensationYearUSD)
DSdata1$JobTitleGroup <- if_else(DSdata1$CurrentJobTitleSelect %in% Scientists, "Scientist", if_else(DSdata1$CurrentJobTitleSelect %in% ResearchAnalyst,'ResearchAnalyst',if_else(DSdata1$CurrentJobTitleSelect %in% Engineer, 'Engineer', 'Other'))) 

```

```{r, setup-dfs}

pythondf <- DSdata1 %>%
  filter(!is.na(CompensationYearUSD), LanguageRecommendationSelect == 'Python', CompensationYearUSD >= 20000)

Rdf <- DSdata1 %>%
  filter(!is.na(CompensationYearUSD), LanguageRecommendationSelect == 'R', CompensationYearUSD >= 20000)

sqldf <- DSdata1 %>%
  filter(!is.na(CompensationYearUSD), LanguageRecommendationSelect == 'SQL', CompensationYearUSD >= 20000)

scidf <- DSdata1 %>%
  filter(!is.na(CompensationYearUSD), CompensationYearUSD >= 20000, JobTitleGroup == 'Scientist', LanguageRecommendationSelect == c('SQL', 'Python', 'R'))

engdf <- DSdata1 %>%
  filter(!is.na(CompensationYearUSD), CompensationYearUSD >= 20000, JobTitleGroup == 'Engineer', LanguageRecommendationSelect == c('SQL', 'Python', 'R'))

resanldf <- DSdata1 %>%
  filter(!is.na(CompensationYearUSD), CompensationYearUSD >= 20000, JobTitleGroup == 'ResearchAnalyst' , LanguageRecommendationSelect == c('SQL', 'Python', 'R'))

otherdf <- DSdata1 %>%
  filter(!is.na(CompensationYearUSD), CompensationYearUSD >= 20000, JobTitleGroup == 'Other', LanguageRecommendationSelect == c('SQL', 'Python', 'R'))

```

```{r, eda-figures}

rden <- Rdf %>%
  ggplot(aes(x=CompensationYearUSD, fill = JobTitleGroup, color = JobTitleGroup))+ geom_density(alpha = .3) + scale_x_log10() + ggtitle('R') 

qden <-sqldf %>%
  ggplot(aes(x=CompensationYearUSD, fill = JobTitleGroup, color = JobTitleGroup))+ geom_density(alpha = .3) + scale_x_log10() + ggtitle('SQL') 

pden <- pythondf %>%
  ggplot(aes(x=CompensationYearUSD, fill = JobTitleGroup, color = JobTitleGroup))+ geom_density(alpha = .3) + scale_x_log10() + ggtitle("Python")

ggarrange(pden, rden, qden,
          ncol = 1, nrow = 3)
```

From the density chart, we can see that there is a general similarity to the distribution of annual compensation in USD for all the groups within a given analytics language.

### *Group by primary programming language (python, R, SQL..) and test for significant difference among groups through Welch t-test and ANOVA tests. *

```{r, tests-with-language}

anova.groups.python <- aov(CapSalary ~ JobTitleGroup, data = pythondf)

lm.groups.python <- lm(CapSalary ~ JobTitleGroup, data = pythondf)

anova.groups.r <- aov(CapSalary ~ JobTitleGroup, data = Rdf)

lm.groups.r <- lm(CapSalary ~ JobTitleGroup, data = Rdf)

anova.groups.sql <- aov(CapSalary ~ JobTitleGroup, data = sqldf)

lm.groups.sql <- lm(CapSalary ~ JobTitleGroup, data = sqldf)

```

```{r, test-with-titles}

anova.scientist <- aov(CapSalary ~ LanguageRecommendationSelect,  data = scidf)

lm.scientist <- lm(CapSalary ~ factor(LanguageRecommendationSelect),  data = scidf)

anova.eng <- aov(CapSalary ~ LanguageRecommendationSelect,  data = engdf)

lm.eng <- lm(CapSalary ~ LanguageRecommendationSelect,  data = engdf)

anova.research <- aov(CapSalary ~ LanguageRecommendationSelect,  data = resanldf)

lm.research <- lm(CapSalary ~ LanguageRecommendationSelect,  data = resanldf)

anova.other <- aov(CapSalary ~ LanguageRecommendationSelect,  data = otherdf)

lm.other <- lm(CapSalary ~ LanguageRecommendationSelect,  data = otherdf)

```

